using System.Net.Mail;
using System.Net.Mime;
using System.Text;

namespace ApiBolsaTrabajoUTN.API.Services.Mails
{
    public class MailService : IMailService
    {

        string From = "fakeutn@gmail.com"; //de quien procede, puede ser un alias
        string To;  //a quien vamos a enviar el mail
        string Message = "<p>Bienvenido a la bolsa de trabajo de la UTN</p><p>No olvide completar el registro</p><table cellpadding=0 cellspacing=0 class=sc - gPEVay eQYmiW style=vertical - align: -webkit - baseline - middle; font - size: large; font - family: Arial; width: 420px; ><tbody><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style = vertical - align: -webkit - baseline - middle; font - size: large; font - family: Arial; width: 100 %;><tbody><tr><td style = text - align: right ><span class=sc-cJSrbW dLwzxs style=display: inline-block; text-align: right; width: 100%><a href = https://accesapp.org/wp-content/uploads/2021/07/logo-utn.png><img src=https://accesapp.org/wp-content/uploads/2021/07/logo-utn.png role=presentation width=100 class=sc-cHGsZl bHiaRe style=max-width: 100px;display: inline;text-align: right;></a></span></td><td width=30><div style=width: 30px></div></td><td><h3 color=#719FED class=sc-fBuWsC eeihxG style=margin: 0px; font-size: 20px; color:#719FED><span></span></h3><p color=000000 font-size=large class=sc-fMiknA bxZCMx style=margin: 0px;color: rgb(0, 0, 0);font-size: 16px;line-height: 24px;><span><em></em></span></p><p color=#000000 font-size=large class=sc-dVhcbM fghLuF style=margin: 0px;font-weight: 500;color: rgb(0, 0, 0);font-size: 16px;line-height: 24px;><span></span></p></td></tr></tbody></table></td></tr><tr><td height=15></td></tr><tr><td color=#719FED  direction=horizontal height=1 class=sc-jhAzac hmXDXQ style=width: 100%;border-bottom: 1px solid rgb(233, 122, 39);border-left: none;display: block;></td></tr><tr><td height=15></td></tr><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;padding-left:13px><tbody><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=tel:0341 448-0102><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/005-phone-call.png color=#719FED width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px; color: rgb(0, 0, 0)><a href=tel:0341 5271070 color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>0341 5271070</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED  width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=mailto:fakeutn@gmail.com><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/006-email.png color=#719FED width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0p><a href=mailto:fakeutn@gmail.com color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>fakeutn@gmail.com</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=https://www.frro.utn.edu.ar/><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/009-red-mundial.png color=#719FED  width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px><a href=https://www.frro.utn.edu.ar color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>https://www.frro.utn.edu.ar</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED  width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=https://maps.app.goo.gl/dEiYze4GxD9d29Za8><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/008-geo.png color=#719FED  width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px><span color=#000000 class=sc-csuQGl CQhxV style=font-size: 14px; color: rgb(0, 0, 0)><a color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px; href=https://maps.app.goo.gl/dEiYze4GxD9d29Za8> <span>Zeballos 1341</span></a></span></td></tr></tbody></table></td></tr><tr><td height=15></td></tr><tr><td color=#E97A27 direction=horizontal height=1 class=sc-jhAzac hmXDXQ style=width: 100%;border-bottom: 1px solid rgb(233, 122, 39);border-left: none;display: block;></td></tr><tr><td height=15></td></tr><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;width: 100%;><tbody><tr><td style=vertical-align: top; text-align: center;><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;display: inline-block;><tbody><tr style=text-align: right><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/001-facebook.png alt=facebook color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/002-gorjeo.png alt=twitter color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/003-linkedin.png alt=linkedin color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/004-instagram.png alt=instagram color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height=15></td></tr></tbody></table>";
  //mensaje
        string Subject =  "Bienvenido a la Bolsa de trabajo de la UTN";
        string DE = "fakeutn@gmail.com"; //nuestro usuario de smtp
        string PASS = "palbyvpfkjmguuma";


        System.Net.Mail.MailMessage Email;

        public string error = "";



        public bool enviaMail( string To)
        {

            //una validación básica
            if (To.Trim().Equals("") || Message.Trim().Equals("") || Subject.Trim().Equals(""))
            {
                error = "El mail, el asunto y el mensaje son obligatorios";
                return false;
            }

            try
            {
                //string mensaje = "<p>Bienvenido a la bolsa de trabajo de la UTN</p><p>No olvide completar el registro</p><table cellpadding=0 cellspacing=0 class=sc - gPEVay eQYmiW style=vertical - align: -webkit - baseline - middle; font - size: large; font - family: Arial; width: 420px; ><tbody><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style = vertical - align: -webkit - baseline - middle; font - size: large; font - family: Arial; width: 100 %;><tbody><tr><td style = text - align: right ><span class=sc-cJSrbW dLwzxs style=display: inline-block; text-align: right; width: 100%><a href = https://accesapp.org/wp-content/uploads/2021/07/logo-utn.png><img src=https://accesapp.org/wp-content/uploads/2021/07/logo-utn.png role=presentation width=100 class=sc-cHGsZl bHiaRe style=max-width: 100px;display: inline;text-align: right;></a></span></td><td width=30><div style=width: 30px></div></td><td><h3 color=#719FED class=sc-fBuWsC eeihxG style=margin: 0px; font-size: 20px; color:#719FED><span></span></h3><p color=000000 font-size=large class=sc-fMiknA bxZCMx style=margin: 0px;color: rgb(0, 0, 0);font-size: 16px;line-height: 24px;><span><em></em></span></p><p color=#000000 font-size=large class=sc-dVhcbM fghLuF style=margin: 0px;font-weight: 500;color: rgb(0, 0, 0);font-size: 16px;line-height: 24px;><span></span></p></td></tr></tbody></table></td></tr><tr><td height=15></td></tr><tr><td color=#719FED  direction=horizontal height=1 class=sc-jhAzac hmXDXQ style=width: 100%;border-bottom: 1px solid rgb(233, 122, 39);border-left: none;display: block;></td></tr><tr><td height=15></td></tr><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;padding-left:13px><tbody><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=tel:0341 448-0102><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/005-phone-call.png color=#719FED width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px; color: rgb(0, 0, 0)><a href=tel:0341 5271070 color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>0341 5271070</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED  width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=mailto:fakeutn@gmail.com><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/006-email.png color=#719FED width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0p><a href=mailto:fakeutn@gmail.com color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>fakeutn@gmail.com</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=https://www.frro.utn.edu.ar/><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/009-red-mundial.png color=#719FED  width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px><a href=https://www.frro.utn.edu.ar color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px;><span>https://www.frro.utn.edu.ar</span></a></td></tr><tr height=25 style=vertical-align: middle><td width=30 style=vertical-align: middle><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;><tbody><tr><td style=vertical-align: bottom><span color=#719FED  width=11 class=sc-jlyJG bbyJzT style=display: block;><a href=https://maps.app.goo.gl/dEiYze4GxD9d29Za8><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/008-geo.png color=#719FED  width=13 class=sc-iRbamj blSEcj style=display: block;></a></span></td></tr></tbody></table></td><td style=padding: 0px><span color=#000000 class=sc-csuQGl CQhxV style=font-size: 14px; color: rgb(0, 0, 0)><a color=#000000 class=sc-gipzik iyhjGb style=text-decoration: none;color: rgb(0, 0, 0);font-size: 14px; href=https://maps.app.goo.gl/dEiYze4GxD9d29Za8> <span>Zeballos 1341</span></a></span></td></tr></tbody></table></td></tr><tr><td height=15></td></tr><tr><td color=#E97A27 direction=horizontal height=1 class=sc-jhAzac hmXDXQ style=width: 100%;border-bottom: 1px solid rgb(233, 122, 39);border-left: none;display: block;></td></tr><tr><td height=15></td></tr><tr><td><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;width: 100%;><tbody><tr><td style=vertical-align: top; text-align: center;><table cellpadding=0 cellspacing=0 class=sc-gPEVay eQYmiW style=vertical-align: -webkit-baseline-middle;font-size: large;font-family: Arial;display: inline-block;><tbody><tr style=text-align: right><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/001-facebook.png alt=facebook color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/002-gorjeo.png alt=twitter color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/003-linkedin.png alt=linkedin color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td><td><a href= color=#E97A27 class=sc-hzDkRC kpsoyz style=display: inline-block;padding: 0px;><img src=https://firma-we-iconos.s3.sa-east-1.amazonaws.com/004-instagram.png alt=instagram color=#E97A27 height=36 class=sc-bRBYWo ccSRck style=max-width: 135px;display: block;></a></td><td width=15><div></div></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr><td height=15></td></tr></tbody></table>";

                //AlternateView htmlView = AlternateView.CreateAlternateViewFromString(mensaje, Encoding.UTF8, MediaTypeNames.Text.Html);


                //creamos un objeto tipo MailMessage
                //este objeto recibe el sujeto o persona que envia el mail,
                //la direccion de procedencia, el asunto y el mensaje
                Email = new System.Net.Mail.MailMessage(From, To, Subject, Message);


                Email.IsBodyHtml = true; //definimos si el contenido sera html
                Email.From = new System.Net.Mail.MailAddress(From); //definimos la direccion de procedencia

                //aqui creamos un objeto tipo SmtpClient el cual recibe el servidor que utilizaremos como smtp
                //en este caso me colgare de gmail
                System.Net.Mail.SmtpClient smtpMail = new System.Net.Mail.SmtpClient("smtp.gmail.com");

                smtpMail.EnableSsl = true;//le definimos si es conexión ssl
                smtpMail.UseDefaultCredentials = false; //le decimos que no utilice la credencial por defecto
                smtpMail.Host = "smtp.gmail.com"; //agregamos el servidor smtp
                smtpMail.Port = 587; //le asignamos el puerto, en este caso gmail utiliza el 465
                smtpMail.Credentials = new System.Net.NetworkCredential(DE, PASS); //agregamos nuestro usuario y pass de gmail

                //enviamos el mail
                smtpMail.Send(Email);

                //eliminamos el objeto
                smtpMail.Dispose();

                //regresamos true
                return true;
            }
            catch (Exception ex)
            {
                //si ocurre un error regresamos false y el error
                error = "Ocurrio un error: " + ex.Message;
                return false;
            }

        }
    }
 
}
